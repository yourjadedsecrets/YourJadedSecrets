<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gatekeeper · YJS</title>
  <style>
    :root{
      --bg:#050505;
      --ink:#e4dcc3;
      --muted:#bfb396;
      --gold:#b89c59;
      --red:#7b0f1f;
      --line:#2a241a;
      --radius:18px;
      --shadow:0 18px 60px rgba(0,0,0,.55);
      --max:1120px;
    }
    *{box-sizing:border-box;}
    body{
      margin:0; min-height:100vh; padding:24px 18px 60px;
      color:var(--ink); font-family:"Playfair Display", serif;
      background:
        radial-gradient(950px 640px at 18% 12%, rgba(123,15,31,.24), transparent 60%),
        radial-gradient(820px 560px at 82% 70%, rgba(184,156,89,.14), transparent 62%),
        linear-gradient(180deg, rgba(0,0,0,.18), rgba(0,0,0,.92)),
        var(--bg);
    }
    a{ color:inherit; text-decoration:none; }
    .wrap{ max-width:var(--max); margin:0 auto; }
    header{
      display:flex; align-items:flex-start; justify-content:space-between; gap:16px;
      padding:10px 0 18px; border-bottom:1px solid rgba(42,36,26,.85);
      flex-wrap:wrap;
    }
    .brand{ letter-spacing:.18em; font-weight:700; font-size:16px; text-transform:uppercase; }
    .sub{ display:block; margin-top:6px; font-size:12px; letter-spacing:.12em; text-transform:uppercase; color:var(--muted); opacity:.9; }
    nav{
      display:flex; gap:14px; flex-wrap:wrap; justify-content:flex-end; padding-top:2px;
      font-size:12px; letter-spacing:.12em; text-transform:uppercase; color:var(--muted);
    }
    nav a{ border-bottom:1px solid transparent; padding-bottom:2px; color:var(--muted); }
    nav a:hover{ border-bottom-color:var(--gold); color:var(--ink); }

    .panel{
      margin-top:16px;
      border:1px solid rgba(42,36,26,.85);
      border-radius:14px;
      padding:16px;
      background:rgba(0,0,0,.22);
      box-shadow: 0 10px 28px rgba(0,0,0,.35);
    }
    h1{ margin:0 0 8px; font-size:34px; line-height:1.1; }
    h2{ margin:0 0 10px; font-size:13px; letter-spacing:.16em; text-transform:uppercase; color:#d8c9a6; }
    p{ margin:0 0 10px; color:var(--muted); font-size:14px; }
    label{
      display:block;
      margin:14px 0 8px;
      font-size:11px;
      letter-spacing:.14em;
      text-transform:uppercase;
      color:#d8c9a6;
    }
    input, textarea{
      width:100%;
      padding:12px 14px;
      border-radius:12px;
      border:1px solid rgba(184,156,89,.28);
      background:rgba(0,0,0,.30);
      color:var(--ink);
      outline:none;
      font-family:inherit;
      font-size:14px;
    }
    textarea{ min-height:140px; resize:vertical; }
    input:focus, textarea:focus{ border-color:var(--gold); box-shadow:0 0 0 3px rgba(184,156,89,.10); }
    .row{ display:grid; grid-template-columns: 1fr 1fr; gap:12px; }
    @media(max-width:900px){ .row{ grid-template-columns:1fr; } }

    .btnrow{ display:flex; gap:12px; flex-wrap:wrap; margin-top:14px; }
    .btn{
      appearance:none;
      border:1px solid var(--gold);
      background:transparent;
      color:var(--ink);
      padding:11px 16px;
      border-radius:12px;
      font-size:12px;
      letter-spacing:.14em;
      text-transform:uppercase;
      cursor:pointer;
      display:inline-block;
    }
    .btn:hover{ background:var(--gold); color:#0b0b0b; }
    .btn.secondary{
      border-color:#6a5a35;
      color:var(--muted);
      background: rgba(0,0,0,.14);
    }
    .btn.secondary:hover{ background:#19140d; color:var(--ink); }
    .note{ font-size:12px; color:#9b9078; letter-spacing:.06em; margin-top:10px; }
    .toast{
      position:fixed; left:50%; bottom:18px; transform:translateX(-50%);
      background:rgba(0,0,0,.78); border:1px solid var(--gold);
      border-radius:14px; padding:10px 12px; color:var(--ink);
      font-size:12px; letter-spacing:.08em; display:none; box-shadow: var(--shadow); z-index:9999;
    }
    .toast.show{ display:block; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <div class="brand">Your Jaded Secrets</div>
        <span class="sub">Gatekeeper · settings (device-local)</span>
      </div>
      <nav>
        <a href="index.html">Home</a>
        <a href="rooms.html">Rooms</a>
        <a href="vault.html">Vault</a>
        <a href="observatory.html">Observatory</a>
      </nav>
    </header>

    <section class="panel">
      <h1>Gatekeeper</h1>
      <p>These settings live on <em>this device</em>. Perfect for you. Useless for the public (as intended).</p>

      <div class="row">
        <div>
          <h2>Inner Chamber Phrase</h2>
          <p>Controls <code>inner-chamber.html</code>. Rotate it whenever.</p>
          <label for="innerPhrase">Current Phrase</label>
          <input id="innerPhrase" type="text" placeholder="e.g., VELVET FLAME" />
          <div class="note">Stored as <code>yjsInnerPhrase</code>.</div>
        </div>

        <div>
          <h2>Vault Phrases</h2>
          <p>Optional: store a phrase list used by Vault (if your Vault reads <code>yjsVaultSettings</code>).</p>
          <label for="vaultPhrases">Phrases (one per line)</label>
          <textarea id="vaultPhrases" placeholder="PHRASE ONE&#10;PHRASE TWO&#10;PHRASE THREE"></textarea>
          <div class="note">Stored inside <code>yjsVaultSettings.phrases</code>.</div>
        </div>
      </div>

      <div class="row" style="margin-top:12px;">
        <div>
          <h2>Vault Window</h2>
          <p>Optional: set an open window (24h time). If your Vault supports it, it will respect this.</p>
          <div class="row">
            <div>
              <label for="openStart">Open Start</label>
              <input id="openStart" type="text" placeholder="00:00" />
            </div>
            <div>
              <label for="openEnd">Open End</label>
              <input id="openEnd" type="text" placeholder="03:33" />
            </div>
          </div>
          <div class="note">Stored inside <code>yjsVaultSettings.window</code>.</div>
        </div>

        <div>
          <h2>Closed Message</h2>
          <label for="closedMsg">Message</label>
          <textarea id="closedMsg" placeholder="The Vault is closed. Return at midnight."></textarea>
          <div class="note">Stored inside <code>yjsVaultSettings.closedMessage</code>.</div>
        </div>
      </div>

      <div class="btnrow">
        <button class="btn" id="save" type="button">Save</button>
        <button class="btn secondary" id="load" type="button">Load</button>
        <button class="btn secondary" id="reset" type="button">Reset</button>
      </div>

      <p class="note">If you want these settings to follow you across devices, we’ll need a backend. For now: sovereign, local, quiet.</p>
    </section>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    const toast = document.getElementById("toast");
    function show(msg){
      toast.textContent = msg;
      toast.classList.add("show");
      clearTimeout(window.__t);
      window.__t = setTimeout(()=>toast.classList.remove("show"), 2200);
    }

    const KEY_INNER = "yjsInnerPhrase";
    const KEY_VAULT = "yjsVaultSettings";

    const innerPhrase = document.getElementById("innerPhrase");
    const vaultPhrases = document.getElementById("vaultPhrases");
    const openStart = document.getElementById("openStart");
    const openEnd = document.getElementById("openEnd");
    const closedMsg = document.getElementById("closedMsg");

    function load(){
      try{
        innerPhrase.value = (localStorage.getItem(KEY_INNER) || "");
      }catch(e){}

      let v = {};
      try{ v = JSON.parse(localStorage.getItem(KEY_VAULT) || "{}"); }catch(e){ v = {}; }
      vaultPhrases.value = (v.phrases || []).join("\n");
      openStart.value = (v.window && v.window.start) ? v.window.start : "";
      openEnd.value = (v.window && v.window.end) ? v.window.end : "";
      closedMsg.value = v.closedMessage || "";
      show("Loaded.");
    }

    function save(){
      try{
        localStorage.setItem(KEY_INNER, (innerPhrase.value || "").trim());
      }catch(e){}

      const phrases = (vaultPhrases.value || "")
        .split(/\r?\n/)
        .map(s => s.trim())
        .filter(Boolean);

      const v = {
        phrases,
        window: { start: (openStart.value||"").trim(), end: (openEnd.value||"").trim() },
        closedMessage: (closedMsg.value||"").trim()
      };

      try{ localStorage.setItem(KEY_VAULT, JSON.stringify(v)); }catch(e){}
      show("Saved.");
      try{ window.__yjsObs && window.__yjsObs.bump && window.__yjsObs.bump("gatekeeper_save"); }catch(e){}
    }

    function reset(){
      try{ localStorage.removeItem(KEY_INNER); }catch(e){}
      try{ localStorage.removeItem(KEY_VAULT); }catch(e){}
      innerPhrase.value = "";
      vaultPhrases.value = "";
      openStart.value = "";
      openEnd.value = "";
      closedMsg.value = "";
      show("Reset.");
    }

    document.getElementById("load").addEventListener("click", load);
    document.getElementById("save").addEventListener("click", save);
    document.getElementById("reset").addEventListener("click", reset);

    load();
  </script>
</body>
</html>
