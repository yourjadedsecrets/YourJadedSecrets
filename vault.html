<!DOCTYPE html>
<html lang="en">
<head>
  
  <meta name="yjs-min-age" content="18" />
<meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>The Vault · Your Jaded Secrets</title>
  
  <link rel="stylesheet" href="assets/age-gate.css" />
<style>
    :root{
      --bg:#050505;
      --panel:rgba(0,0,0,.66);
      --ink:#e4dcc3;
      --muted:#bfb396;
      --gold:#b89c59;
      --red:#7b0f1f;
      --line:#2a241a;
      --radius:18px;
      --shadow:0 18px 60px rgba(0,0,0,.55);
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px 18px;
      color:var(--ink);
      font-family:"Playfair Display", serif;
      background:
        radial-gradient(900px 620px at 18% 12%, rgba(123,15,31,.22), transparent 60%),
        radial-gradient(820px 560px at 82% 70%, rgba(184,156,89,.14), transparent 62%),
        linear-gradient(180deg, rgba(0,0,0,.18), rgba(0,0,0,.92)),
        var(--bg);
    }
    a{ color:inherit; text-decoration:none; border-bottom:1px solid rgba(184,156,89,.28); }
    a:hover{ border-bottom-color:var(--gold); }

    .wrap{ width:100%; max-width:980px; }
    .card{
      border:1px solid var(--gold);
      border-radius:var(--radius);
      background:var(--panel);
      box-shadow:var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .top{
      padding:18px 18px 14px;
      border-bottom:1px solid rgba(42,36,26,.9);
      background:
        radial-gradient(560px 360px at 18% 20%, rgba(179,18,55,.18), transparent 62%),
        radial-gradient(520px 320px at 82% 35%, rgba(184,156,89,.10), transparent 64%),
        rgba(0,0,0,.20);
    }
    .kicker{
      margin:0 0 10px;
      font-size:12px;
      letter-spacing:.18em;
      text-transform:uppercase;
      color:var(--muted);
    }
    h1{
      margin:0 0 10px;
      font-size:40px;
      line-height:1.05;
    }
    .lead{
      margin:0;
      color:var(--muted);
      font-size:14.5px;
      max-width:860px;
    }

    .body{ padding:18px; }

    .rule{
      border:1px solid rgba(42,36,26,.9);
      border-radius:14px;
      padding:14px;
      background:rgba(0,0,0,.22);
      margin-bottom:12px;
      position:relative;
      overflow:hidden;
    }
    .rule::before{
      content:"";
      position:absolute;
      inset:-70px -70px auto auto;
      width:280px;
      height:280px;
      background: radial-gradient(circle at 30% 30%, rgba(184,156,89,.12), transparent 64%);
      transform: rotate(18deg);
      pointer-events:none;
    }
    .rule strong{
      display:block;
      letter-spacing:.14em;
      text-transform:uppercase;
      font-size:12px;
      margin-bottom:8px;
      color:var(--ink);
      position:relative;
      z-index:1;
    }
    .rule p{
      margin:0;
      color:var(--muted);
      font-size:14px;
      position:relative;
      z-index:1;
    }

    label{
      display:block;
      font-size:12px;
      letter-spacing:.14em;
      text-transform:uppercase;
      color:var(--muted);
      margin:14px 0 8px;
    }
    input, textarea{
      width:100%;
      border:1px solid rgba(184,156,89,.45);
      background: rgba(0,0,0,.35);
      color:var(--ink);
      padding:12px 12px;
      border-radius:12px;
      outline:none;
      font-family:inherit;
      font-size:14px;
    }
    textarea{ min-height:96px; resize:vertical; }

    .consent{
      display:flex;
      gap:10px;
      align-items:flex-start;
      margin-top:12px;
      padding:12px;
      border-radius:12px;
      border:1px solid rgba(42,36,26,.9);
      background:rgba(0,0,0,.18);
      color:var(--muted);
      font-size:13.5px;
    }
    .consent input{ width:18px; height:18px; margin-top:2px; }

    .btnrow{ display:flex; gap:12px; flex-wrap:wrap; margin-top:14px; }
    .btn{
      appearance:none;
      border:1px solid var(--gold);
      background:transparent;
      color:var(--ink);
      padding:11px 16px;
      border-radius:12px;
      font-size:12px;
      letter-spacing:.14em;
      text-transform:uppercase;
      cursor:pointer;
      display:inline-block;
    }
    .btn:hover{ background:var(--gold); color:#0b0b0b; }
    .btn.secondary{
      border-color:#6a5a35;
      color:var(--muted);
      background: rgba(0,0,0,.14);
    }
    .btn.secondary:hover{ background:#19140d; color:var(--ink); }

    .fine{
      margin-top:12px;
      font-size:12px;
      color:#9b9078;
      letter-spacing:.06em;
    }
    .status{
      margin-top:10px;
      padding:12px;
      border-radius:12px;
      border:1px solid rgba(184,156,89,.22);
      background: rgba(0,0,0,.18);
      color:#a79a82;
      font-size:13px;
      display:none;
    }

    .trial{
      display:none;
      margin-top:14px;
    }
    .q{
      margin-top:12px;
      padding:12px;
      border-radius:12px;
      border:1px solid rgba(42,36,26,.85);
      background:rgba(0,0,0,.18);
    }
    .q .qt{
      font-size:12px;
      letter-spacing:.12em;
      text-transform:uppercase;
      color:var(--muted);
      margin-bottom:8px;
    }
    .opts label{
      margin:8px 0 0;
      font-size:13.5px;
      letter-spacing:.02em;
      text-transform:none;
      color:var(--ink);
      display:flex;
      gap:10px;
      align-items:flex-start;
    }
    .opts input{ width:16px; height:16px; margin-top:3px; }
  
    .lock-seal{width:96px;height:auto;display:block;margin:14px auto 10px;opacity:.95;filter:drop-shadow(0 0 22px rgba(120,160,255,.22));}
    .lock-seal.hidden{display:none;}
</style>
<link rel="stylesheet" href="assets/polish.css">
</head>
<body data-page="vault">
  <div class="wrap">
    <div class="card">
      <div class="top">
        <p class="kicker">If you’re here, you were meant to be.</p>
        <h1>The Vault</h1>
        <p class="lead">New doors appear without announcement. This one opens on a schedule, and it does not apologize.</p>
      </div>

      <div class="body">
        <div class="rule">
          <strong>Window</strong>
          <p id="windowText">Checking the door…</p>
        </div>

        <div class="rule">
          <strong>Phrase</strong>
          <p>Enter what you were given. If you weren’t given anything, you’re early.</p>
          <img id="lockSeal" class="lock-seal" src="images/seal-of-brine.png" alt="Seal of Brine" />
          <label for="phrase">Invitation phrase</label>
          <input id="phrase" type="password" private draft="Enter phrase" autocomplete="off" />
          <div class="consent">
            <input id="consent" type="checkbox" />
            <div>
              <div style="letter-spacing:.12em; text-transform:uppercase; font-size:12px; color:var(--ink);">Consent</div>
              <div>I consent to what I’m choosing. I am responsible for what opens when I open this door.</div>
            </div>
          </div>
          <div class="btnrow">
            <button class="btn" id="unlockBtn" type="button">Unlock</button>
            <a class="btn secondary" href="inner-altar.html" data-min-age="21">Return to the Altar</a>
            <a class="btn secondary" href="index.html">Back to YJS</a>
          </div>
          <div class="status" id="status"></div>
          <div class="fine">Soft doesn’t mean safe.</div>
        </div>

        <div class="trial" id="trial">
          <div class="rule">
            <strong>The Trial</strong>
            <p>30 seconds. No performance. Choose your answers and mean them.</p>
          </div>

          <div class="q">
            <div class="qt">What do you want, really?</div>
            <div class="opts">
              <label><input type="radio" name="q1" value="sovereignty">Sovereignty. I’m tired of permission.</label>
              <label><input type="radio" name="q1" value="luxury">Luxury with standards. Not chaos.</label>
              <label><input type="radio" name="q1" value="desire">Desire with structure. Consent-first.</label>
            </div>
          </div>

          <div class="q">
            <div class="qt">What will you stop tolerating?</div>
            <div class="opts">
              <label><input type="radio" name="q2" value="crumbs">Crumbs. I’m not starving anymore.</label>
              <label><input type="radio" name="q2" value="noise">Noise. I want clean signal.</label>
              <label><input type="radio" name="q2" value="selfbetrayal">Self-betrayal. I’m done.</label>
            </div>
          </div>

          <div class="q">
            <div class="qt">What are you willing to protect?</div>
            <div class="opts">
              <label><input type="radio" name="q3" value="time">My time.</label>
              <label><input type="radio" name="q3" value="body">My body and nervous system.</label>
              <label><input type="radio" name="q3" value="future">My future and the life I’m building.</label>
            </div>
          </div>

          <div class="btnrow">
            <button class="btn" id="sealBtn" type="button">Seal the Vault</button>
            <button class="btn secondary" id="cancelBtn" type="button">Not Today</button>
          </div>

          <div class="status" id="trialStatus"></div>
          <div class="fine">If you share the door, you lose the door.</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Static-site "Vault": ceremony + friction. Not security.
    const VAULT_KEY = "yjsVaultSigil";
    const VAULT_TIER = "yjsVaultTier";
    const SETTINGS_KEY = "yjsVaultSettings";

    // Defaults (fallbacks)
    let PHRASES = ["PRIESTESS", "HIGH PRIESTESS", "DANGEROUS SOFT", "YOU DONT NEED PERMISSION"];
    let OPEN_START_MIN = 23*60 + 55;
    let OPEN_END_MIN = 0*60 + 15;
    let CLOSED_MSG = "Closed. Come back at 11:55 PM (local time). New doors appear without announcement.";

    // Load device-local settings (Gatekeeper page writes these)
    try{
      const raw = localStorage.getItem(SETTINGS_KEY);
      if(raw){
        const s = JSON.parse(raw);
        if(Array.isArray(s.phrases) && s.phrases.length) PHRASES = s.phrases.map(x => (x||"").toString().trim().toUpperCase());
        if(typeof s.start === "number") OPEN_START_MIN = s.start;
        if(typeof s.end === "number") OPEN_END_MIN = s.end;
        if(typeof s.closedMsg === "string" && s.closedMsg.trim()) CLOSED_MSG = s.closedMsg.trim();
      }
    }catch(e){}

    // Midnight-ish window is local device time by design.

    const phraseEl = document.getElementById("phrase");
    const consentEl = document.getElementById("consent");
    const unlockBtn = document.getElementById("unlockBtn");
    const status = document.getElementById("status");
    const trial = document.getElementById("trial");
    const windowText = document.getElementById("windowText");

    const trialStatus = document.getElementById("trialStatus");
    const sealBtn = document.getElementById("sealBtn");
    const cancelBtn = document.getElementById("cancelBtn");

    function normalize(v){
      return (v || "").trim().toUpperCase().replace(/\s+/g, " ");
    }

    function nowMins(){
      const d = new Date();
      return d.getHours()*60 + d.getMinutes();
    }

    function isOpen(){
      const m = nowMins();
      // window crosses midnight
      return (m >= OPEN_START_MIN) || (m <= OPEN_END_MIN);
    }

    function windowMsg(){
      const open = isOpen();
      if(open){
        return "Open now: 11:55 PM to 12:15 AM (local time).";
      }
      return CLOSED_MSG;
    }

    function showStatus(el, msg){
      el.style.display = "block";
      el.textContent = msg;
    }

    function makeSigil(){
      const chars = "ABCDEFGHJKLMNPQRSTUVWXYZ23456789";
      let out = "";
      for(let i=0;i<10;i++) out += chars[Math.floor(Math.random()*chars.length)];
      return "YJS-" + out;
    }

    function getSelected(name){
      const el = document.querySelector('input[name="'+name+'"]:checked');
      return el ? el.value : "";
    }

    function tierFromAnswers(a1,a2,a3){
      // simple tier mapping
      const set = [a1,a2,a3].join("|");
      if(set.includes("sovereignty") && set.includes("future")) return "inner";
      if(set.includes("luxury") && set.includes("time")) return "initiate";
      return "observer";
    }

    function tryAutoForward(){
      try{
        const sigil = localStorage.getItem(VAULT_KEY);
        if(sigil){
          // already sealed once on this device
          try{ window.__yjsObs && window.__yjsObs.bump("vault_sealed"); }catch(e){}
      window.location.href = "vault-reward.html";
        }
      }catch(e){}
    }

    function startTrial(){
      const lockSeal = document.getElementById("lockSeal");
      if(lockSeal) lockSeal.classList.add("hidden");

      trial.style.display = "block";
      showStatus(status, "Phrase accepted. Proceed to the Trial.");
      // small scroll for mobile
      setTimeout(() => trial.scrollIntoView({behavior:"smooth", block:"start"}), 200);
    }

    function unlock(){
      try{ window.__yjsObs && window.__yjsObs.bump("vault_unlock_attempt"); }catch(e){}
      status.style.display = "none";

      if(!isOpen()){
        showStatus(status, "Closed. Respect the hours.");
        return;
      }
      const attempt = normalize(phraseEl.value);
      if(!attempt){
        showStatus(status, "Enter the phrase.");
        return;
      }
      if(!consentEl.checked){
        showStatus(status, "Check consent. Nobody drags you into power.");
        return;
      }
      const ok = PHRASES.includes(attempt);
      if(!ok){
        showStatus(status, "Not the phrase.");
        return;
      }
      try{ window.__yjsObs && window.__yjsObs.bump("vault_phrase_accepted"); }catch(e){}
      startTrial();
    }

    function seal(){
      trialStatus.style.display = "none";
      const a1 = getSelected("q1");
      const a2 = getSelected("q2");
      const a3 = getSelected("q3");
      if(!a1 || !a2 || !a3){
        showStatus(trialStatus, "Answer all three. This isn’t a vibe check, it’s a decision.");
        return;
      }
      const sigil = makeSigil();
      const tier = tierFromAnswers(a1,a2,a3);

      try{
        localStorage.setItem(VAULT_KEY, sigil);
        localStorage.setItem(VAULT_TIER, tier);
      }catch(e){}

      window.location.href = "vault-reward.html";
    }

    function cancel(){
      trial.style.display = "none";
      showStatus(status, "Door closed. Come back when you mean it.");
    }

    unlockBtn.addEventListener("click", unlock);
    phraseEl.addEventListener("keydown", (e) => { if(e.key === "Enter") unlock(); });
    sealBtn.addEventListener("click", seal);
    cancelBtn.addEventListener("click", cancel);

    windowText.textContent = windowMsg();

    // If already unlocked on this device, skip ceremony.
    tryAutoForward();
  </script>

  <script>
    // Observatory counters (device-local). Not tracking people. Tracking signals.
    (function(){
      const KEY = "yjsObs";
      function load(){ try{ return JSON.parse(localStorage.getItem(KEY) || "{}"); }catch(e){ return {}; } }
      function save(o){ try{ localStorage.setItem(KEY, JSON.stringify(o)); }catch(e){} }
      const o = load();
      const page = (location.pathname.split("/").pop() || "index.html");
      o.pageViews = o.pageViews || {};
      o.pageViews[page] = (o.pageViews[page] || 0) + 1;
      o.lastSeen = new Date().toISOString();
      o.lastPage = page;
      save(o);
      // expose tiny helper
      window.__yjsObs = {
        bump: function(evt){
          const x = load();
          x.events = x.events || {};
          x.events[evt] = (x.events[evt] || 0) + 1;
          x.lastEvent = evt;
          x.lastSeen = new Date().toISOString();
          save(x);
        }
      };
    })();
  </script>


<script>
(function(){
  try{
    if(localStorage.getItem("yjsCoronated")){
      document.querySelectorAll(".return-world").forEach(el=>el.style.display="inline-block");
    }
  }catch(e){}
})();
</script>

  <script src="assets/age-gate.js"></script>
</body>

</html>